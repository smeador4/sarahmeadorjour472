---
title: "Data Analysis Project Group 2: Board Game Ratings"
author: "Eli Cohen, Sarah Meador, Tim Williams"
date: "4/24/24"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load libraries

```{r}
options(scipen=999)
# Load libraries
library(tidyverse)
library(janitor)
library(stringr)
```

# Data cleaning and first analysis

The dataset is pulled from BoardGameGeek, a user-submitted website for game ratings. The data was pulled about three years ago. There 20,343 rows and 14 columns. An initial analysis of shows about 19,900 games in the dataset. There are some columns with some missing data, such as year published.

```{r}
#Dataset was cleaned in OpenRefine to replace semicolon-separated values with comma-separated values, and to convert rating values with commas to values with decimals. It was also clustered to clean about 75 games that had similar name variants.
bgg <- read_csv("bgg_dataset_clean.csv") |> clean_names()

#count games in set
bgg |>
  group_by(name) |>
  summarise()

#highest rated game by average
bgg |>
  group_by(name) |>
  arrange(desc(rating_average))

#highest ranked game (Board Game Geek standardizes the average rating values, rewarding games with more reviews)
bgg |>
  group_by(name) |>
  arrange(desc(bgg_rank))

#average game play time: This isn't grouped, not sure how to do that here. Get a very small number when I try that.
bgg |>
    mutate(total_time = sum(play_time)) |>
    mutate(avg_time = total_time/20343)

```

```{r}
#seeing how many games are in each category, a limitation of this is that we will have to figure out how to separate the ones that have multiple categories listed. 
bgg |>
  group_by(domains) |>
  summarize(count = n()) |>
  arrange(desc(count))

```

```{r}
#This chunk tells us the average rating for each cluster of games. As mentioned above, we will have to figure out how to separate the domains. We have tried many different methods and can't find a good solution to separate the domains since some entries have two listed, but when we figure that out we want to see the average rating per type of game or "domain."

bgg <- bgg |>
  mutate(
    family = case_when(
        str_detect(domains, "Family Games") ~ "family",
        .default = NA
    )
  ) |>
  mutate(
    strategy = case_when(
        str_detect(domains, "Strategy Games") ~ "strategy",
        .default = NA
    )
  )

ratings <- bgg |>
  group_by(family) |>
  summarize(average = mean(rating_average)) |>
  arrange(desc(average))

ratings <- bgg |>
  group_by(strategy) |>
  summarize(average = mean(rating_average)) |>
  arrange(desc(average))

#trying a bit of a different method
family_games <- bgg |>
  filter(str_detect(domains, "Family"))
  
family_rating <- family_games |>  
  summarize(average = mean(rating_average)) |>
  arrange(desc(average))
```

```{r}
#
family_games <- bgg |>
  filter(str_detect(domains, "Family"))
  
family_rating <- family_games |>  
  summarize(average = mean(rating_average)) |>
  arrange(desc(average))

```

```{r}
#percentage of how many people rated the game out of how many users own the game. Not sure why some are over 100.
bgg <- bgg |>
  mutate(pct_rated = (users_rated/owned_users*100))
```

```{r}
#average game play time for top 100 games: Getting an error here.
bgg |>
  filter(bgg_rank<101) |>
  summarise(total_time = sum(play_time)) |>
  summarise(top_avg_time = total_time/n())
```

```{r}
bgg [c('type1', 'type2', 'type3')] <- str_split_fixed(bgg$domains, ',', 3) |>
  filter(str_detect(type1, 'Strategy Games')) 
```

```{r}

```
